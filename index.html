<!DOCTYPE html>
<html>

<head>
	<title>vue_todo</title>
</head>
<script src="https://unpkg.com/vue"></script>
<style type="text/css">
	.active input {
		text-decoration: line-through
	}
</style>

<body>
	<div>
		<div id="gyf_todo_example">
			<input v-model='newTodoText' v-on:keyup.enter='addNewTodo' placeholder="what do you need to do?">
			<ul>
				<li is='todo' v-for='(todo,index) in todos' v-bind:class="{ active:todo.isActive }" v-bind:key='todo.id' v-bind:title='todo.title'
				 v-on:remove='todos.splice(index,1)' v-on:done='alreadyDone(todo.id)'></li>
			</ul>
			<fina :number='lefNum'  v-bind:todos='todos' v-on:all='allArr'  @activel='activeArr' :times='time' ></fina>
			<!--  @completed='completedArr' -->
	</div>
</body>
<script>
	
	Vue.component('todo', {
		template: `
  <li>
    <button v-on:click="$emit('done')">Done</button>
	<input v-model='newText'>
	<button v-on:click="$emit('remove')">X</button>
  </li>`,
		props: ['title'],
		data: function () {
			return { newText: this.title };
		}
	})
	
	
	// 	<button v-on:click="$emit('completed')">Completed</button>
	Vue.component('fina', {
		template: `	
		<div v-if='exist' >
		<div>{{number}} item left</div>
		<button v-on:click="$emit('all')">All</button>
		<button v-on:click="$emit('activel')">Active</button>
		</div>
		`,
		props: ['number','todos','times'],
		// data:function(){
		// 	let i=0;
		// 	return{counter:i++};
		// },
		computed:{
			exist: function () {
				return this.todos.length !== 0&&this.times!==0;
			}
		}
	})
	let text = new Vue({
		el: '#gyf_todo_example',
		data: {
			todos: [],
			newTodoText: '',
			nextTodoId: 1,
			time:0
		},
		methods: {
			addNewTodo: function () {
				this.todos.push({
					id: this.nextTodoId++,
					title: this.newTodoText,
					isActive: false
				});
				this.newTodoText = '';
				this.time++;
			},
			alreadyDone: function (key) {
				let todo = this.todos.filter(function (value) {
					return value.id === key;
				})[0];
				let index = this.todos.indexOf(todo);
				this.todos[index].isActive = true;
			},
			allArr: function () {
				
				return this.todos =baseArr;
			},
			activeArr: function () {
				var baseArr = this.todos.concat();
				return this.todos =baseArr.filter(function (value) {
					return value.isActive === false;
				});
			}
		},
		computed: {		
			lefNum: function () {
				let leftArr =this.todos.filter(function (value) {
					return value.isActive === false;
				});
				return leftArr.length;
			},
			
			
			// completedArr: function () {
			// 	return this.todos = baseArr.filter(function (element) {
			// 		return element.isActive === true;
			// 	});
			// },
		}

	});

</script>

</html>